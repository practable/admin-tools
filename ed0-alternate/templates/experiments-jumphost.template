#!/bin/bash

# example: ./jumphost pvna 05 06 https://dev.practable.io/jump some_secret

mkdir -p ./autogenerated &> /dev/null | true
cd ./autogenerated

export JUMP_TOKEN_AUDIENCE=$4
export JUMP_TOKEN_CONNECTION_TYPE=connect
export JUMP_TOKEN_LIFETIME=165456000
export JUMP_TOKEN_ROLE=host
export JUMP_TOKEN_SECRET=$5

for i in $(seq $2 $3)
do
    num=$(printf "%02d" $i)
		name="${1}${num}"
		out="jump.env.${name}"
		export JUMP_TOKEN_TOPIC="${name}"
		token=$(../../bin/jump token)
	cat <<EOF > $out
JUMP_HOST_LOCAL_PORT=22
JUMP_HOST_DEVELOPMENT=true
JUMP_HOST_ACCESS=${4}/api/v1/connect/${name}
JUMP_HOST_TOKEN=${token}
EOF
 	
done
